; Top Design: "MSW_lib:EM_analysys:schematic"
; Netlisted using Hierarchy Policy: "Standard"

Options ResourceUsage=yes UseNutmegFormat=no EnableOptim=no TopDesignName="MSW_lib:EM_analysys:schematic" DcopOutputNodeVoltages=yes DcopOutputPinCurrents=yes DcopOutputAllSweepPoints=no DcopOutputDcopType=0
; Library Name: MSW_lib
; Cell Name: EM_Inner
; View Name: emModel
define EM_Inner ( P1  P2  P3  P4  P5  P6  P7  P8  P9  P10  P11  P12  Ref=0 ) 
parameters  W50=1.2 mm  Lfeed=5.6 mm  WZ=1.55 mm  LZ=53.75 mm  WZT=2.7 mm  LZT=52.25 mm  Set=(C/sqrt(2))+(WZT-WZ)/2  C=0.5*(sqrt(2*sqrt(2)*((ResL)^2)+4*((ResL)^2)-(WZT^2)+2*WZT*WZ-(WZ^2))-sqrt(2)*WZT-WZT+sqrt(2)*WZ+WZ)  ResL=3.1 mm  ResW=1.6 mm 
; MomCmpt model has node 0 as implicit reference. Ref node will be ignored and assumed to be grounded!
em_data_name="MSW_lib:EM_Inner:emModel"
em_data_p0="W50"
em_data_v0=W50
em_data_p1="Lfeed"
em_data_v1=Lfeed
em_data_p2="WZ"
em_data_v2=WZ
em_data_p3="LZ"
em_data_v3=LZ
em_data_p4="WZT"
em_data_v4=WZT
em_data_p5="LZT"
em_data_v5=LZT
em_data_p6="Set"
em_data_v6=Set
em_data_p7="C"
em_data_v7=C
em_data_p8="ResL"
em_data_v8=ResL
em_data_p9="ResW"
em_data_v9=ResW
MomCmpt:em_data  P1 P2 P3 P4 P5 P6 P7 P8 P9 P10 \
   P11 P12 \
    name=em_data_name \
    paramFile="" \
    modelFile="C:/Users/User/Desktop/Stuffdy/ADS/ADS_AFU/Multistage_Wilkinson_V2/MSW_wrk/MSW_lib/%E%M_%Inner/em%Model/model.ndx" \
    p0="W50" v0=W50 v0_Resolution=0.0001 mm \
    p1="Lfeed" v1=Lfeed v1_Resolution=0.0001 mm \
    p2="WZ" v2=WZ v2_Resolution=0.0001 mm \
    p3="LZ" v3=LZ v3_Resolution=0.0001 mm \
    p4="WZT" v4=WZT v4_Resolution=0.0001 mm \
    p5="LZT" v5=LZT v5_Resolution=0.0001 mm \
    p6="Set" v6=Set v6_Resolution=0.0001 mm \
    p7="C" v7=C v7_Resolution=0.0001 mm \
    p8="ResL" v8=ResL v8_Resolution=0.0001 mm \
    p9="ResW" v9=ResW v9_Resolution=0.0001 mm \
    ModelReuse=1 \
    ModelType="MOMMW" \
    ExtrapolationMode="linear" \
    EnforcePassivity=-1
end EM_Inner

Port:TermG4  N__36 0 Num=4 Z=50 Ohm Noise=yes 
Port:TermG2  N__35 0 Num=2 Z=50 Ohm Noise=yes 
Port:TermG1  N__44 0 Num=1 Z=50 Ohm Noise=yes 
Port:TermG3  N__38 0 Num=3 Z=50 Ohm Noise=yes 

R1=26 Ohm
R2=180 Ohm

Fc=0.9 GHz
Fl=Fc-Fp
Fu=Fc+Fp
Fp=100 MHz
S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=no SortNoise=0 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=0 GHz Stop=3.5 GHz Step=0.01 GHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2
EM_Inner:X1  N__44 N__35 N__38 N__36 N__7 N__8 N__2 N__16 N__13 N__14 N__15 N__0 W50=1.2 mm Lfeed=5.6 mm WZ=1.55 mm LZ=50 mm WZT=2.5 mm LZT=50 mm Set=(C/sqrt(2))+(WZT-WZ)/2 C=0.5*(sqrt(2*sqrt(2)*((ResL)^2)+4*((ResL)^2)-(WZT^2)+2*WZT*WZ-(WZ^2))-sqrt(2)*WZT-WZT+sqrt(2)*WZ+WZ) ResL=3.1 mm ResW=1.6 mm 
R:R11  N__7 N__8 R=R1 
R:R21  N__13 N__14 R=R2 
R:R12  N__16 N__2 R=R1 
R:R22  N__0 N__15 R=R2 

ResL1=3.1 mm
